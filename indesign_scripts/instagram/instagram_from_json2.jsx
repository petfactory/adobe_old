if(typeof JSON!=="object"){JSON={}}(function(){"use strict";function f(e){return e<10?"0"+e:e}function quote(e){escapable.lastIndex=0;return escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return typeof t==="string"?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var n,r,i,s,o=gap,u,a=t[e];if(a&&typeof a==="object"&&typeof a.toJSON==="function"){a=a.toJSON(e)}if(typeof rep==="function"){a=rep.call(t,e,a)}switch(typeof a){case"string":return quote(a);case"number":return isFinite(a)?String(a):"null";case"boolean":case"null":return String(a);case"object":if(!a){return"null"}gap+=indent;u=[];if(Object.prototype.toString.apply(a)==="[object Array]"){s=a.length;for(n=0;n<s;n+=1){u[n]=str(n,a)||"null"}i=u.length===0?"[]":gap?"[\n"+gap+u.join(",\n"+gap)+"\n"+o+"]":"["+u.join(",")+"]";gap=o;return i}if(rep&&typeof rep==="object"){s=rep.length;for(n=0;n<s;n+=1){if(typeof rep[n]==="string"){r=rep[n];i=str(r,a);if(i){u.push(quote(r)+(gap?": ":":")+i)}}}}else{for(r in a){if(Object.prototype.hasOwnProperty.call(a,r)){i=str(r,a);if(i){u.push(quote(r)+(gap?": ":":")+i)}}}}i=u.length===0?"{}":gap?"{\n"+gap+u.join(",\n"+gap)+"\n"+o+"}":"{"+u.join(",")+"}";gap=o;return i}}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()}}var cx,escapable,gap,indent,meta,rep;if(typeof JSON.stringify!=="function"){escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;meta={"\b":"\\b","  ":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};JSON.stringify=function(e,t,n){var r;gap="";indent="";if(typeof n==="number"){for(r=0;r<n;r+=1){indent+=" "}}else if(typeof n==="string"){indent=n}rep=t;if(t&&typeof t!=="function"&&(typeof t!=="object"||typeof t.length!=="number")){throw new Error("JSON.stringify")}return str("",{"":e})}}if(typeof JSON.parse!=="function"){cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;JSON.parse=function(text,reviver){function walk(e,t){var n,r,i=e[t];if(i&&typeof i==="object"){for(n in i){if(Object.prototype.hasOwnProperty.call(i,n)){r=walk(i,n);if(r!==undefined){i[n]=r}else{delete i[n]}}}}return reviver.call(e,t,i)}var j;text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}})()var font_size = 20;var font_name = "Avenir Next";var font_style = "Regular";//var leading = 24;var date_font_style = "Ultra Light";var page_width = 1100;var page_height = 1100;var image_percent = .7;var image_width = page_width * image_percent;var image_height = page_height * image_percent;var image_offset_y = (page_height - image_height)*.5;var image_offset_x = (page_width - image_width)*.5;var text_offset_y = 12;var text_height = 200;// users selects the root dirvar root_dir = "/Users/johan/.virtualenvs/testInsta/download";var img_dir = root_dir+"/magick";var file = File(root_dir+"/instagram.json");if (file){    if (file.open("r"))    {        file.encoding = "UTF-8";        var json = file.read();        json_obj = JSON.parse(json);        file.close();        var media = json_obj.media;        //$.writeln (media)        var num_media = media.length;                        var my_doc = app.documents.add();        with(my_doc.documentPreferences){        pageWidth = page_width+"px";        pageHeight = page_height+"px";        pageOrientation = PageOrientation.landscape;        pagesPerDocument = num_media+2;        //facingPages = false;        }        var image_layer = my_doc.activeLayer;        image_layer.name = "image";        var text_layer = my_doc.layers.add({name: "text"});                    for (var i = 0; i < num_media; i++)        {            var filename = media[i].filename;            var image_path = img_dir +"/"+filename;            var text = media[i].text;                        var date = media[i].date;                        var parts = date.match(/(\d+)/g)            var d = new Date(Date.UTC(parts[0], parts[1]-1, parts[2]));                        var monthNames = [            "Januari", "Februari", "Mars",            "April", "May", "Juni", "Juli",            "Augusti", "September", "Oktober",            "November", "December"            ];                    var year = d.getFullYear()            var month = monthNames[d.getMonth()]            var day = d.getDate();                        var day_month = day + "  " + month;            //$.writeln(year +" "+ day +" "+ month);            //$.writeln(image_path);            //$.writeln(text);            //$.writeln("\n");            $.writeln(day_month.length);            add_media(my_doc, image_path, day_month, text, i+1)                    }    }    }function add_media(my_doc, image_path, day_month, text, start_page){    var even_page = start_page % 2;    left_offset = even_page ? page_width : 0;    var page = my_doc.pages.item(start_page);    var image_frame = page.textFrames.add(image_layer);        var y1 = image_offset_y;    var x1 = image_offset_x + left_offset;    var y2 = y1 + image_height;    var x2 = x1 + image_width;        image_frame.geometricBounds = [y1+"px", x1+"px", y2+"px", x2+"px"];        image_frame.place (image_path, false);    image_frame.fit (FitOptions.CONTENT_TO_FRAME);    image_frame.fit (FitOptions.PROPORTIONALLY);    image_frame.fit (FitOptions.CENTER_CONTENT);        var myTextFrame = page.textFrames.add(text_layer);    myTextFrame.geometricBounds = [y1+image_height+text_offset_y+"px", x1+"px", y1+image_height+text_offset_y+text_height+"px", x2+"px"];    myTextFrame.contents = day_month +" " + text;        var myText = myTextFrame.parentStory     myText.pointSize = font_size;    myText.appliedFont = app.fonts.item(font_name);    myText.fontStyle = font_style;    //myText.leading = leading;         myTextFrame.words[0].fontStyle = date_font_style;    myTextFrame.words[1].fontStyle = date_font_style;}